<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="../../common/syntax/syntax.css" />
		<link rel="stylesheet" type="text/css" href="../../common/css/slides2.css" />
		<link rel="stylesheet" type="text/css" href="../../common/css/skin/cvut/skin.css" />
		<script src="../../common/js/oz.js" type="text/javascript"></script>
		<script src="../../common/js/slides2.js" type="text/javascript"></script>
		<script src="../../common/syntax/syntax.js" type="text/javascript"></script>
		<meta name="viewport" content="width=device-width,user-scalable=0" />
		<title>Cross-browser, nové HTML značky</title>
		<base target="_blank" />

		<script src="//cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/0.5.2/webcomponents-lite.min.js"></script>
		<link rel="import" href="instant-button/instant-button.html" />
	<body>
		
<h1>Cross-browser, nové HTML značky</h1>

<section class="slide">
	<h2>Cross-browser, nové HTML značky</h2>
	<ul>
		<li>Webová interaktivní prezentace</li>
		<li>"?" zobrazí krátkou nápovědu</li>
		<li>Tisk jako obvykle</li>
		<li>Pro pokračování stiskněte mezerník</li>
	</ul>
</section>

<section class="slide">
	<h2>Obsah</h2>
	<ol>
		<li>Webové prohlížeče: každý pes, jiná ves</li>
		<li>HTML5 audio a video</li>
		<li>Conteneditable</li>
	</ol>
</section>

<section class="slide">
	<h2>Webové prohlížeče</h2>
	<table>
		<thead>
			<tr>
				<td>Jméno</td><td>Verze</td><td>Renderer</td><td>JavaScript</td><td>Poznámka</td>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Mozilla Firefox</td><td>44</td><td>Gecko</td><td><em>Spider</em>Monkey</td><td></td>
			</tr>
			<tr>
				<td>Google Chrome</td><td>48</td><td>Blink/WebKit</td><td>V8</td><td></td>
			</tr>
			<tr>
				<td>Apple Safari</td><td>9</td><td>WebKit</td><td>JSC</td><td>Existovala verze pro Windows</td>
			</tr>
			<tr>
				<td>Microsoft Internet Explorer / Edge</td><td>11/13</td><td>Trident</td><td>Chakra</td><td>Zajímavý až od verze 9</td>
			</tr>
			<tr>
				<td>Opera</td><td>12/35</td><td>Presto/Blink</td><td>Carakan/V8</td><td></td>
			</tr>
		</tbody>
	</table>
</section>

<section class="slide">
	<h2>Webové prohlížeče: mobilní</h2>
	<ul>
		<li>Apple Mobile Safari (iOS)</li>
		<li>Android Browser (Android)</li>
		<li>Opera Mobile (Android, Symbian, Windows Mobile)</li>
		<li>Firefox for Android (Android)</li>
		<li>Chrome for Android (Android, trošičku iOS)</li>
		<li>Internet Explorer Mobile (Windows Mobile)</li>
	</ul>
</section>

<section class="slide">
	<h2>Webové prohlížeče: zpětná kompatibilita</h2>
	<ul>
		<li>Nutnost definovat podporovaný <em>feature set</em></li>
		<li>Oříznout starý prohlížeč znamená připravit se o uživatele</li>
		<li>Oříznout starý prohlížeč znamená motivovat k upgrade</li>
		<li>Časté aktualizace = snazší rozhodování</li>
	</ul>
</section>

<section class="slide">
	<h2>Webové prohlížeče: co kdo umí</h2>
	<ul>
		<li><a href="http://caniuse.com/">http://caniuse.com/</a>
			<ul>
				<li>Srovnávací tabulky</li>
				<li>Odkazy na testy</li>
			</ul>
		</li>
		<li><a href="https://developer.mozilla.org/cs/">Mozilla Developer Network</a>
			<ul>
				<li>Dokumentace</li>
				<li>Ukázky</li>
			</ul>
		</li>
		<li><a href="http://diveintohtml5.info/detect.html">Feature detection</a></li>
	</ul>
</section>

<section class="slide">
	<h2>Volitelné nabízení pokročilých technologií</h2>
	<ul>
		<li><strong>Progressive enhancement:</strong> nabízet základní funkcionalitu a volitelně přidávat</li>
		<li><strong>Graceful degradation:</strong> nabízet pokročilou funkcionalitu a v případě nouze couvnout</li>
	</ul>
</section>

<section class="slide">
	<h2>Polyfill</h2>
	<ul>
		<li><strong>Polyfill:</strong> JavaScriptový kód, který je schopen doplnit chybějící funkcionalitu při zachování kompatibilního API</li>
		<li><pre data-syntax="js">
if (!("onhashchange" in window)) {
	var oldHash = window.hash;
	setTimeout(function() {
		if (window.hash == oldHash) return;
		oldHash = window.hash;
		if (window.onhashchange) window.onhashchange();
	}, 100);
}
</pre></li>
	</ul>
</section>

<section class="slide">
	<h2>HTML5 Audio</h2>
	<ul class="section">
		<li>Vložení zvukového souboru do stránky</li>
		<li>Ovládací prvky vyrábí prohlížeč (jsou-li požadovány)</li>
		<li>Různé prohlížeče rozumí různým formátům zvukových souborů</li>
		<li>Možnost specifikovat více formátů</li>
		<li>Možnost zadat alternativní obsah pro nekompatibilní prohlížeče</li>
	</ul>
	<p class="section">
		<audio controls>
			<source src="sound.ogg" type="audio/ogg" />
			<source src="sound.mp3" type="audio/mpeg" />
			<source src="sound.wav" type="audio/wave" />
			Smůla :-(
		</audio>
	</p>
	<pre data-syntax="xml" class="section">&lt;audio controls&gt;
	&lt;source src="sound.ogg" type="audio/ogg" /&gt;
	&lt;source src="sound.mp3" type="audio/mpeg" /&gt;
	&lt;source src="sound.wav" type="audio/wave" /&gt;
	Smůla :-(
&lt;/audio&gt;</pre>
</section>

<section class="slide">
	<h2>HTML5 Audio: JavaScriptové API</h2>
	<pre data-syntax="js">new Audio("song.mp3").play();</pre>
	<pre data-syntax="js">var a = new Audio();
a.canPlayType("audio/mpeg"); /* "", "maybe", "probably" */
a.src = "song.mp3";
a.addEventListener("timeupdate", function() { console.log(a.currentTime); }, false);
a.play();</pre>

	<p>
		<instant-button color="red" src="instant-button/buzzer.{ogg,mp3}"></instant-button>
		<instant-button color="lime" src="instant-button/tada.{ogg,mp3}"></instant-button>
	</p>
</section>

<section class="slide">
	<h2>HTML5 Video</h2>
	<ul>
		<li>Vložení videa do stránky</li>
		<li>Alternativa pro Flashové přehrávače</li>
		<li>Syntaxe téměř shodná s audiem</li>
		<li>Ještě výraznější problematika formátů</li>
		<li>S výhodou použití <code class="syntax-xml">&lt;source media="..." /&gt;</code></li>
	</ul>
</section>

<section class="slide">
	<h2>HTML5 Video: ukázka</h2>
	<pre data-syntax="xml">&lt;video controls poster="image.png"&gt;
	&lt;source src="video-small.mp4" 
		type="video/mp4; codecs='avc1.42E01E, mp4a.40.2'" 
		media="screen and (max-width:500px)" 
	/&gt;
	&lt;source src="video.mp4" type="video/mp4; codecs='avc1.42E01E, mp4a.40.2'" /&gt;
	&lt;source src="video.ogv" type="video/ogg; codecs='theora, vorbis'"/&gt;
	&lt;source src="video.webm" type="video/webm; codecs='vp8, vorbis'" /&gt;
	&lt;!-- embed flash jako fallback --&gt;
&lt;/video&gt;</pre>
</section>

<section class="slide">
	<h2>&lt;audio&gt; &lt;video&gt; formáty</h2>
	<p><a href="https://developer.mozilla.org/en-US/docs/HTML/Supported_media_formats">Tabulka</a></p>
</section>

<section class="slide">
	<h2>Web Audio API</h2>
	<ul>
		<li>Poměrně moderní JS API</li>
		<li>Konstrukce <a href="img/WebAudioBasics.png" target="_blank">zvukového grafu</a></li>
		<li>Uzly = transformace zvuku</li>
		<li>Přístup k právě přehrávaným datům (vizualizace)</li>
		<li>Generování zvukového signálu</li>
		<li><a href="http://ondras.github.io/fireworks-webgl/">Ohňostroj</a>, <a href="http://ondras.github.io/oscope/">osciloskop</a></li>
	</ul>
</section>

<section class="slide">
	<h2>Web Audio API: generování zvuku</h2>
<pre data-syntax="js">
var ctx = new AudioContext();

var oscillator = ctx.createOscillator();

oscillator.frequency.value = 440;
oscillator.connect(ctx.destination);

oscillator.start();
</pre>
	<ul>
		<li>Tvar vlny možno určit vlastností <code>type</code></li>
		<li>Jak zastavit běžící oscilátor?</li>
	</ul>
</section>

<section class="slide" contenteditable onkeydown="event.stopPropagation()">
	<h2>Atribut contenteditable</h2>
	<p><code contenteditable="true" data-syntax="xml">&lt;div contenteditable="true"&gt;ahoj&lt;/div&gt;</code></p>
	<ul>
		<li>Obsah prvku lze po kliknutí upravovat</li>
		<li>Základní stavební prvek WYSIWYG editorů (nikoliv GDrive)</li>
		<li>Manipulace pomocí DOM + Range</li>
		<li>Bonus: v takovém prvku lze použít <code>execCommand</code> API</li>
		<li><code data-syntax="js">document.execCommand("bold")</code></li>
		<li>Implementace execCommand nekonzistentní, <a href="https://developer.mozilla.org/en-US/docs/Web/API/document.execCommand">dokumentace</a></li>
	</ul>
</section>

<section class="slide">
	<h2>Atribut contenteditable &ndash; range &amp; selection</h2>
	<ul>
		<li>Při práci s WYSIWYG editorem často pracujeme s vybraným textem</li>
		<li>Rozhraní <a href="https://developer.mozilla.org/en-US/docs/Web/API/Selection"><code>Selection</code></a> je <em>nesouvislá množina výběrů</em></li>
		<li>Rozhraní <a href="https://developer.mozilla.org/en-US/docs/Web/API/Range"><code>Range</code></a> je <em>jeden rozsah označeného textu</em></li>
		<li>Obě rozhraní nabízí komplexní API</li>
	</ul>
</section>

<section class="slide">
	<h2>Objekt <code>Range</code></h2>
	<ul>
		<li>Rozsah textu</li>
		<li>Od (uzel, pozice), do (uzel, pozice)</li>
		<li>Nesouvisí přímo s vizuální stránkou</li>
	</ul>
	<pre data-syntax="js">
var range = document.createRange();
r.collapsed; // true: start = end

r.set{Start,End}{Before,After}(node);
r.selectNode(node);
r.selectNodeContents(node);

// ... manipulace s vybraným fragmentem, porovnávání s jiným rozsahem
</pre>
</section>

<section class="slide">
	<h2>Objekt <code>Selection</code></h2>
	<ul>
		<li>Historicky množina rozsahů, nyní typicky jen jeden</li>
		<li>Vizuální reprezentace</li>
		<li>Možno ovlivňovat programově nebo myší/klávesnicí</li>
	</ul>
	<pre data-syntax="js">
var sel = document.getSelection();
sel.addRange(range); // range je nyní vidět

sel.removeAllRanges();

sel.getRangeAt(0);
sel.deleteFromDocument();

sel.anchorNode; // zde táhnutí započalo
sel.focusNode;  // zde táhnutí ukončilo
</pre>
</section>

<section class="slide">
	<h2>Prostor pro otázky</h2>
</section>

<footer>
	<a href="http://twitter.com/0ndras">twitter.com/0ndras</a>
	<a href="mailto:ondrej.zara@firma.seznam.cz">ondrej.zara@firma.seznam.cz</a>
</footer>

<script type="text/javascript">
	Syntax.all();
	new Presentation();
</script>

</body>
</html>
